<!doctype html>
<html lang="en" class="dark">
<head>
  <meta charset="utf-8" />
  <title>SamNet Live Radar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="color-scheme" content="dark" />
  <meta name="theme-color" content="#020617" />

  <!-- Resource hints (faster load) -->
  <link rel="preconnect" href="https://cdn.tailwindcss.com" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <link rel="preconnect" href="https://api.open-meteo.com" crossorigin>
  <link rel="preconnect" href="https://api.planespotters.net" crossorigin>
  <link rel="preconnect" href="https://server.arcgisonline.com" crossorigin>
  <link rel="preconnect" href="https://basemaps.cartocdn.com" crossorigin>
  <link rel="preconnect" href="https://images.unsplash.com" crossorigin>

  <!-- Social Media Preview Tags -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="SamNet Live Radar" />
  <meta property="og:description" content="Real-time local ADS-B aircraft tracking." />
  <meta property="og:image" content="https://www.samnet.dev/blog/radar/radar.jpg" />
  <meta property="og:url" content="https://www.samnet.dev/" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="SamNet Live Radar" />
  <meta name="twitter:description" content="Real-time local ADS-B aircraft tracking." />
  <meta name="twitter:image" content="https://www.samnet.dev/blog/radar/radar.jpg" />

  <!-- Favicon (Centered) -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text x=%2250%25%22 y=%2250%25%22 dominant-baseline=%22central%22 text-anchor=%22middle%22 font-size=%2280%22>‚úàÔ∏è</text></svg>">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Leaflet CSS/JS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <style>
    html, body { height: 100%; width: 100%; overflow: hidden; }
    #map { height: 100%; width: 100%; background: #020617; }
    :root { color-scheme: dark; }
    body { -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility; }

    .drawer {
      transition: transform 320ms cubic-bezier(0.22, 1, 0.36, 1), opacity 220ms ease;
      will-change: transform, opacity;
    }
    .nice-scroll::-webkit-scrollbar { width: 6px; }
    .nice-scroll::-webkit-scrollbar-track { background: transparent; }
    .nice-scroll::-webkit-scrollbar-thumb { background: rgba(148,163,184,0.25); border-radius: 99px; }
    .nice-scroll::-webkit-scrollbar-thumb:hover { background: rgba(148,163,184,0.45); }
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

    /* Plane Transitions */
    .plane-container {
      will-change: transform;
      transition: transform 250ms linear;
      filter: drop-shadow(0 3px 6px rgba(0,0,0,0.35));
      transform-origin: 50% 50%;
    }
    .theme-dark .plane-path { stroke: #0f172a; stroke-width: 0.6px; }
    .theme-sat .plane-path { stroke: #000000; stroke-width: 0.8px; }
    .theme-light .plane-path { stroke: #ffffff; stroke-width: 1.1px; }

    /* GLOW EFFECT for Selected Plane */
    .plane-selected {
      filter: drop-shadow(0 0 15px #38bdf8) drop-shadow(0 0 5px white);
      transform: scale(1.15);
      z-index: 1000 !important;
    }

    /* Emergency Animation */
    @keyframes pulse-red {
      0% { filter: drop-shadow(0 0 5px rgba(239, 68, 68, 0.7)); transform: scale(1); }
      50% { filter: drop-shadow(0 0 15px rgba(239, 68, 68, 1)); transform: scale(1.15); }
      100% { filter: drop-shadow(0 0 5px rgba(239, 68, 68, 0.7)); transform: scale(1); }
    }
    .plane-emergency {
      animation: pulse-red 1.5s infinite ease-in-out;
      z-index: 2000 !important;
    }
    .plane-emergency .plane-path {
      fill: #ef4444 !important;
      stroke: #7f1d1d !important;
    }

    /* Popup Styling */
    .leaflet-popup-content-wrapper {
      background: rgba(15, 23, 42, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      color: white;
      border-radius: 24px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 0;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      overflow: hidden;
    }
    .leaflet-popup-tip { background: rgba(15, 23, 42, 0.95); border: 1px solid rgba(255,255,255,0.1); border-top: 0; border-left: 0; }
    .leaflet-popup-content { margin: 0; width: 320px !important; max-width: 90vw; }
    .leaflet-container a.leaflet-popup-close-button { display: none; }

    .microgrid {
      background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.05) 1px, transparent 0);
      background-size: 18px 18px;
    }
    .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }

    .range-ring { filter: drop-shadow(0 0 10px rgba(56,189,248,0.85)); }
    .range-halo { filter: drop-shadow(0 0 18px rgba(56,189,248,0.45)); }

    .filter-chip {
      padding: 4px 12px;
      border-radius: 99px;
      font-size: 11px;
      font-weight: 600;
      white-space: nowrap;
      border: 1px solid rgba(148,163,184,0.2);
      background: rgba(15,23,42,0.4);
      color: #94a3b8;
      transition: all 0.2s ease;
    }
    .filter-chip:hover { background: rgba(15,23,42,0.8); color: white; border-color: rgba(255,255,255,0.2); }
    .filter-chip.active {
      background: rgba(56,189,248,0.15);
      color: #38bdf8;
      border-color: rgba(56,189,248,0.5);
      box-shadow: 0 0 10px rgba(56,189,248,0.1);
    }

    /* Legend popover animation */
    .legend-pop {
      transition: transform 180ms ease, opacity 180ms ease;
      transform-origin: top right;
    }

    .cat-VFR { background: #22c55e; color: #020617; }
    .cat-MVFR { background: #3b82f6; color: white; }
    .cat-IFR { background: #ef4444; color: white; }
    .cat-LIFR { background: #a855f7; color: white; }

    /* Plane Photo Styles */
    .plane-photo-container {
      height: 85px;
      width: 100%;
      background: linear-gradient(to bottom, #0f172a, #1e293b);
      position: relative;
      overflow: hidden;
      transition: height 0.4s cubic-bezier(0.25, 1, 0.5, 1);
      border-bottom: 1px solid rgba(255,255,255,0.05);
    }
    .plane-photo-container.has-photo { height: 180px; }
    .plane-photo-img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 0.7s ease;
      z-index: 10;
    }
    .plane-photo-loaded { opacity: 1; }

    /* Close Button Area */
    .popup-close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 50;
      padding: 6px;
      border-radius: 99px;
      background: rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255,255,255,0.8);
      backdrop-filter: blur(4px);
      transition: all 0.2s;
      cursor: pointer;
    }
    .popup-close-btn:hover { background: rgba(255, 255, 255, 0.15); color: white; }

    /* Airport Header Styles */
    #drawerAirportHeader {
      background-size: cover;
      background-position: center;
      transition: background-image 0.5s ease-in-out;
    }
    .header-overlay {
      background: linear-gradient(to top, rgba(2,6,23,1) 0%, rgba(2,6,23,0.7) 60%, rgba(2,6,23,0.3) 100%);
    }

    /* Ops Card Animation */
    .ops-arrow { transition: transform 1s cubic-bezier(0.34, 1.56, 0.64, 1); }

    /* Tooltip styling override */
    [title] { cursor: help; }

    /* Airport marker */
    .airport-pill{
      display:inline-flex; align-items:center; gap:.4rem;
      padding:.35rem .6rem;
      border-radius:999px;
      background: rgba(2,6,23,.80);
      border: 1px solid rgba(148,163,184,.25);
      color:#e2e8f0;
      font-weight: 800;
      font-size: 11px;
      letter-spacing: .08em;
      text-transform: uppercase;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      box-shadow: 0 10px 25px rgba(0,0,0,.35);
    }
    .airport-dot{
      width:8px; height:8px; border-radius:999px;
      background:#38bdf8;
      box-shadow: 0 0 12px rgba(56,189,248,.55);
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      .plane-container { transition: none !important; }
      .plane-emergency { animation: none !important; }
      .drawer, .legend-pop { transition: none !important; }
    }
  </style>
</head>

<body class="bg-slate-950 text-slate-100 font-sans selection:bg-sky-500/30">

  <!-- MAP -->
  <div id="map" class="absolute inset-0 theme-dark z-0"></div>

  <!-- TOAST -->
  <div id="toast" class="hidden absolute top-20 left-1/2 -translate-x-1/2 z-[3000]">
    <div class="bg-red-500/15 border border-red-500/40 text-red-100 px-4 py-2 rounded-xl shadow-xl backdrop-blur-md text-xs font-medium flex items-center gap-2">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
      <span>Connection lost. Using simulated data.</span>
    </div>
  </div>

  <!-- TOP LEFT BRAND -->
  <div class="absolute top-4 left-4 z-[1000] space-y-2">
    <div class="flex items-center gap-3 px-3 py-2 rounded-2xl bg-slate-950/80 border border-slate-800/80 shadow-2xl backdrop-blur-xl microgrid">
      <div class="h-9 w-9 rounded-xl bg-gradient-to-br from-sky-500 to-blue-600 flex items-center justify-center shadow-lg shadow-sky-500/20">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-white drop-shadow-md">
          <path d="M12 3v3m0 12v3M3 12h3m12 0h3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <circle cx="12" cy="12" r="6" stroke="currentColor" stroke-width="2"/>
          <path d="M12 12l4-2" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"/>
        </svg>
      </div>
      <div>
        <h1 class="font-bold tracking-tight text-[15px] text-white leading-none">
          SamNet <span class="text-sky-400 font-light">Radar</span>
        </h1>
        <div class="mt-1 text-[9px] uppercase tracking-wider font-semibold text-slate-400 flex items-center gap-1.5">
          <span class="relative flex h-2 w-2">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-2 w-2 bg-emerald-500"></span>
          </span>
          Live Feed
        </div>
      </div>
    </div>

    <!-- Status + time -->
    <div class="px-3 py-2 rounded-xl bg-slate-950/75 border border-slate-800/80 backdrop-blur-xl shadow-lg microgrid">
      <div class="space-y-1.5 text-[11px]">
        <div class="flex items-center justify-between gap-2">
          <div class="flex items-center gap-2">
            <span id="modePill" class="px-2 py-0.5 rounded-full bg-emerald-500/15 text-emerald-300 border border-emerald-500/30 font-semibold tracking-wide text-[10px]">
              LIVE
            </span>
            <span class="text-slate-400">Updated</span>
          </div>
          <span id="lastUpdate" class="font-mono text-slate-100">--:--:--</span>
        </div>

        <div class="flex items-center justify-between gap-2">
          <div class="flex items-center gap-1.5">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="text-slate-500" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="9"/><path d="M12 7v5l3 3"/>
            </svg>
            <span class="text-slate-400">CT</span>
          </div>
          <span id="ctTime" class="font-mono text-slate-100">--:--:--</span>
        </div>

        <div class="flex items-center justify-between gap-2">
          <div class="flex items-center gap-1.5">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" class="text-slate-500" stroke="currentColor" stroke-width="2">
              <path d="M3 12h18"/><circle cx="12" cy="12" r="9"/>
            </svg>
            <span class="text-slate-400">UTC</span>
          </div>
          <span id="utcTime" class="font-mono text-slate-100">--:--:--</span>
        </div>
      </div>
    </div>
  </div>

  <!-- TOP RIGHT ICON CONTROLS -->
  <div class="absolute top-4 right-4 z-[1000] flex flex-col gap-2">

    <button id="btnList" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Aircraft list" title="Aircraft list">
      <span id="badgeCount" class="absolute -top-1 -right-1 h-5 w-5 bg-sky-500 text-[10px] font-bold text-white flex items-center justify-center rounded-full shadow-lg border border-slate-900">0</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <path d="M4 6h16M4 12h16M4 18h10"/>
      </svg>
    </button>

    <button id="btnLegend" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Altitude legend" title="Altitude color legend">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <circle cx="6" cy="7" r="2" fill="currentColor" stroke="none"/>
        <circle cx="12" cy="7" r="2" fill="currentColor" stroke="none" opacity="0.8"/>
        <circle cx="18" cy="7" r="2" fill="currentColor" stroke="none" opacity="0.6"/>
        <path d="M4 14h16" />
        <path d="M7 18h10" />
      </svg>
    </button>

    <button id="btnTheme" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Switch map style" title="Switch map style (Dark/Light/Sat)">
      <svg id="iconMoon" width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
      <svg id="iconSun" class="hidden text-amber-400" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>
      <svg id="iconSat" class="hidden text-emerald-400" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M2 12h20"/>
        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/>
      </svg>
    </button>

    <button id="btnSpeedUnit" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Toggle speed units" title="Toggle speed units">
      <span id="speedBadge" class="absolute -top-1 -right-1 h-5 min-w-[20px] px-1 bg-slate-800 text-[9px] font-extrabold text-slate-100 flex items-center justify-center rounded-full border border-slate-700 tracking-wider">KTS</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <path d="M20 13a8 8 0 1 0-16 0"/><path d="M12 13l3.5-3.5"/><path d="M6 19h12"/>
      </svg>
    </button>

    <button id="btnFollow" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Follow selected" title="Follow selected">
      <svg id="followIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="8"/><circle cx="12" cy="12" r="2"/><path d="M12 2v3M12 19v3M2 12h3M19 12h3"/>
      </svg>
    </button>

    <button id="btnRangeRing" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="Toggle range ring" title="Toggle range ring">
      <span id="ringBadge" class="absolute -top-1 -right-1 h-5 min-w-[20px] px-1 bg-slate-800 text-[9px] font-extrabold text-slate-100 flex items-center justify-center rounded-full border border-slate-700 tracking-wider">OFF</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="8"/><circle cx="12" cy="12" r="3"/>
      </svg>
    </button>

    <button id="btnAbout" class="relative group h-11 w-11 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl shadow-lg hover:border-sky-500/50 hover:bg-slate-900 transition flex items-center justify-center microgrid"
            aria-label="System info" title="System info">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" class="text-slate-300 group-hover:text-white" stroke="currentColor" stroke-width="2">
        <rect x="3" y="4" width="18" height="6" rx="2"/><rect x="3" y="14" width="18" height="6" rx="2"/>
        <circle cx="7" cy="7" r="1.2" fill="currentColor"/><circle cx="7" cy="17" r="1.2" fill="currentColor"/>
      </svg>
    </button>
  </div>

  <!-- Altitude legend popover -->
  <div id="legendPanel" class="legend-pop hidden absolute top-[68px] right-[68px] z-[1200] w-[250px] rounded-2xl bg-slate-950/95 border border-slate-800 shadow-2xl backdrop-blur-xl microgrid opacity-0 scale-95">
    <div class="px-4 py-3 border-b border-slate-800 flex items-center justify-between">
      <div class="text-xs font-bold text-white tracking-wide">Altitude Colors</div>
      <button id="closeLegend" class="p-1.5 rounded-lg hover:bg-slate-800 text-slate-400 hover:text-white transition" aria-label="Close legend">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M18 6L6 18M6 6l12 12"/>
        </svg>
      </button>
    </div>
    <div class="p-3 space-y-2 text-[11px] text-slate-300">
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#94a3b8"></span>
          <span>Below 1,000 ft</span>
        </div>
        <span class="text-slate-500">Low / Ground</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#22c55e"></span>
          <span>1k ‚Äì 9.9k ft</span>
        </div>
        <span class="text-slate-500">Climb / Pattern</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#38bdf8"></span>
          <span>10k ‚Äì 19.9k ft</span>
        </div>
        <span class="text-slate-500">Mid Alt</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#f59e0b"></span>
          <span>20k ‚Äì 29.9k ft</span>
        </div>
        <span class="text-slate-500">Cruise</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#f97316"></span>
          <span>30k ‚Äì 39.9k ft</span>
        </div>
        <span class="text-slate-500">High Cruise</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-slate-900/50 border border-slate-800 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full" style="background:#fb7185"></span>
          <span>40k+ ft</span>
        </div>
        <span class="text-slate-500">Very High</span>
      </div>
      <div class="flex items-center justify-between rounded-xl bg-red-900/20 border border-red-800/50 px-3 py-2">
        <div class="flex items-center gap-2">
          <span class="h-2.5 w-2.5 rounded-full animate-pulse" style="background:#ef4444"></span>
          <span class="text-red-300 font-bold">EMERGENCY</span>
        </div>
        <span class="text-red-400">7700/7600</span>
      </div>
    </div>
  </div>

  <!-- BOTTOM BAR -->
  <div class="absolute bottom-4 left-4 right-4 z-[1000] flex items-end justify-between pointer-events-none gap-2 safe-bottom">
    <a href="https://samnet.dev" class="pointer-events-auto flex items-center gap-2 px-4 py-2 rounded-full bg-slate-950/80 border border-slate-800 backdrop-blur-xl hover:bg-slate-900 hover:border-sky-500/50 text-xs font-medium text-slate-300 transition microgrid">
      <svg width="15" height="15" viewBox="0 0 24 24" fill="none" class="text-slate-200" stroke="currentColor" stroke-width="2">
        <path d="M3 11l9-8 9 8"/><path d="M5 10v10h14V10"/>
      </svg>
      Home
    </a>

    <div class="pointer-events-auto flex flex-wrap items-center gap-3 px-4 py-2 rounded-2xl bg-slate-950/80 border border-slate-800 backdrop-blur-xl text-[11px] font-mono text-slate-300 shadow-lg microgrid">
      <div class="flex items-center gap-1.5">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="text-slate-400" stroke="currentColor" stroke-width="2">
          <path d="M3 12h18"/><path d="M12 3v18"/>
        </svg>
        <span id="planeCount" class="text-white font-semibold">0</span>
        <span class="text-slate-500">planes</span>
      </div>

      <div class="h-4 w-px bg-slate-800"></div>

      <div class="flex items-center gap-1.5">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="text-slate-400" stroke="currentColor" stroke-width="2">
          <path d="M6 20h12"/><path d="M12 4v16"/><path d="M8.5 8.5L12 5l3.5 3.5"/>
        </svg>
        <span id="maxAlt" class="text-white font-semibold">--</span>
        <span class="text-slate-500">ft</span>
      </div>

      <div class="h-4 w-px bg-slate-800"></div>

      <div class="flex items-center gap-1.5">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" class="text-slate-400" stroke="currentColor" stroke-width="2">
          <path d="M20 13a8 8 0 1 0-16 0"/><path d="M12 13l4-4"/><path d="M6 19h12"/>
        </svg>
        <span id="maxSpd" class="text-white font-semibold">--</span>
        <span id="unitLabel" class="text-slate-500">kts</span>
      </div>
    </div>
  </div>

  <!-- RIGHT DRAWER (AIRCRAFT LIST) -->
  <aside id="drawerList" class="drawer absolute top-0 right-0 h-full w-full sm:w-[380px] bg-slate-950/95 border-l border-slate-800 shadow-2xl z-[1001] translate-x-full opacity-0 backdrop-blur-2xl microgrid">
    <div class="h-full flex flex-col">
      <div class="px-5 py-4 border-b border-slate-800 flex items-center justify-between bg-slate-900/50">
        <div>
          <h2 class="text-sm font-bold text-white">Active Traffic</h2>
          <p class="text-[10px] text-slate-400">DFW Receiver Sector</p>
        </div>
        <button id="closeList" class="p-2 rounded-lg hover:bg-slate-800 text-slate-400 hover:text-white transition">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <div class="p-4 space-y-3 bg-slate-950/30">
        <div class="relative">
          <svg class="absolute left-3 top-2.5 text-slate-500" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
          </svg>
          <input id="search" placeholder="Search callsign / hex / type..." class="w-full bg-slate-900 border border-slate-800 rounded-xl pl-9 pr-3 py-2 text-xs text-white outline-none focus:border-sky-500/50 transition placeholder:text-slate-600"/>
        </div>

        <div class="flex items-center gap-2">
          <select id="sortBy" class="flex-1 bg-slate-900 border border-slate-800 rounded-xl px-3 py-2 text-xs text-slate-200 outline-none focus:border-sky-500/50 transition">
            <option value="alt_baro">Sort by Altitude</option>
            <option value="gs">Sort by Speed</option>
            <option value="flight">Sort by Callsign</option>
          </select>

          <button id="btnCenter" class="px-3 py-2 rounded-xl border border-slate-700 hover:border-sky-500/50 hover:bg-slate-800 text-xs text-slate-300 transition flex items-center justify-center gap-2">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/><path d="M22 12h-4M6 12H2M12 6V2M12 22v-4"/>
            </svg>
            DFW
          </button>
        </div>

        <!-- Filter Chips -->
        <div class="flex gap-2 overflow-x-auto pb-1 no-scrollbar" id="filterContainer">
           <button class="filter-chip active" data-filter="all">All</button>
           <button class="filter-chip" data-filter="ground">Ground</button>
           <button class="filter-chip" data-filter="airborne">Airborne</button>
           <button class="filter-chip" data-filter="emergency">Emergency</button>
        </div>

        <div class="grid grid-cols-3 gap-2 text-center">
          <div class="rounded-xl bg-slate-900/60 border border-slate-800 p-2">
            <div id="kpiTotal" class="text-slate-100 font-bold text-sm">0</div>
            <div class="text-[10px] text-slate-500">Tracked</div>
          </div>
          <div class="rounded-xl bg-slate-900/60 border border-slate-800 p-2">
            <div id="kpiHigh" class="text-slate-100 font-bold text-sm">--</div>
            <div class="text-[10px] text-slate-500">Max Alt</div>
          </div>
          <div class="rounded-xl bg-slate-900/60 border border-slate-800 p-2">
            <div id="kpiFast" class="text-slate-100 font-bold text-sm">--</div>
            <div class="text-[10px] text-slate-500">Max Spd</div>
          </div>
        </div>
      </div>

      <div id="list" class="nice-scroll flex-1 overflow-y-auto p-2 space-y-1"></div>
    </div>
  </aside>

  <!-- AIRPORT DETAILS DRAWER -->
  <aside id="drawerAirport" class="drawer absolute top-0 left-0 h-full w-full sm:w-[360px] bg-slate-950/95 border-r border-slate-800 shadow-2xl z-[1001] -translate-x-full opacity-0 backdrop-blur-2xl microgrid">
    <div class="h-full flex flex-col">
      <div id="drawerAirportHeader" class="relative h-40 flex flex-col justify-end overflow-hidden">
        <div class="absolute inset-0 header-overlay"></div>
        <div class="relative p-5 z-10">
          <button id="closeAirport" class="absolute top-0 right-0 p-2 rounded-full bg-black/20 hover:bg-white/10 text-white transition mt-2 mr-2">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 18M6 6l12 12"/></svg>
          </button>
          <h2 id="aptTitle" class="text-3xl font-black text-white leading-none">DFW</h2>
          <div id="aptName" class="text-xs text-sky-200 font-medium mt-1 opacity-80">Dallas/Fort Worth Intl</div>
          <div class="flex items-center gap-3 mt-3">
            <a id="btnExternalBoard" href="#" target="_blank" class="inline-flex items-center gap-1 px-3 py-1 bg-sky-500/20 hover:bg-sky-500/30 border border-sky-500/50 rounded-lg text-[10px] font-bold text-sky-300 transition">
              <span>View Official Board</span>
              <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg>
            </a>
            <div id="aptLocalTime" class="text-[10px] font-mono text-slate-300 bg-black/30 px-2 py-1 rounded">--:--</div>
          </div>
        </div>
      </div>

      <div class="px-5 py-3 bg-slate-950 border-b border-slate-800">
        <div class="flex items-center justify-between mb-2">
          <div class="flex items-center gap-2">
            <svg class="text-indigo-400" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M16.2 7.8l-2 6.3-6.4 2.1 2-6.3z"/></svg>
            <span class="text-xs font-bold text-slate-200 tracking-wide">FLIGHT OPS</span>
          </div>
          <div class="text-[10px] font-mono text-slate-500">Est. Configuration</div>
        </div>

        <div class="grid grid-cols-2 gap-2">
          <div class="bg-slate-900/50 rounded-lg p-2 border border-slate-800 flex flex-col justify-between relative overflow-hidden">
            <div class="text-[9px] text-slate-500 uppercase font-bold">Flow Direction</div>
            <div id="opsFlow" class="text-sm font-black text-white mt-1">CALCULATING</div>
            <div id="opsFlowSub" class="text-[9px] text-indigo-300 truncate">Wind-based est.</div>
            <svg id="opsFlowIcon" class="absolute bottom-1 right-1 text-slate-800 ops-arrow" width="32" height="32" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L4.5 20.29l.71.71L12 18l6.79 3 .71-.71z"/></svg>
          </div>

          <div class="bg-slate-900/50 rounded-lg p-2 border border-slate-800 flex flex-col justify-between">
            <div class="text-[9px] text-slate-500 uppercase font-bold">Visibility</div>
            <div class="flex items-end gap-1 mt-1">
              <span id="opsVis" class="text-sm font-mono font-bold text-white">--</span>
              <span class="text-[9px] text-slate-500 mb-0.5">sm</span>
            </div>
            <div class="w-full bg-slate-800 h-1 mt-2 rounded-full overflow-hidden">
              <div class="bg-emerald-500 h-full w-full transition-all duration-700" id="opsVisBar"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="px-5 py-4 bg-slate-900/50 border-b border-slate-800">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-xs font-bold text-slate-400 uppercase tracking-wider">Live Conditions</h3>
          <div id="wxCategory" class="text-[10px] font-bold px-2 py-0.5 rounded text-slate-900 bg-slate-600">--</div>
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div class="bg-slate-950/40 rounded-lg p-2 border border-slate-800/50 flex items-center gap-2">
            <svg class="text-sky-400" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z"/></svg>
            <div class="text-sm font-mono text-white" id="wxTemp">--¬∞F</div>
          </div>
          <div class="bg-slate-950/40 rounded-lg p-2 border border-slate-800/50 flex items-center gap-2">
            <svg class="text-slate-400" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2"/><path d="M9.6 4.6A2 2 0 1 1 11 8H2"/><path d="M12.6 19.4A2 2 0 1 0 14 16H2"/></svg>
            <div class="text-sm font-mono text-white" id="wxWind">--</div>
          </div>
        </div>
        <div id="wxRaw" class="mt-2 text-[9px] font-mono text-slate-500 break-words leading-tight opacity-70">Fetching Live Weather...</div>
        <div id="wxSun" class="mt-2 text-[10px] text-slate-400 flex justify-between border-t border-white/5 pt-2">
          <span>‚òÄÔ∏è <span id="sunRise">--:--</span></span>
          <span>üåô <span id="sunSet">--:--</span></span>
        </div>
      </div>

      <div class="flex-1 overflow-y-auto p-4 space-y-4 nice-scroll">
        <div class="text-[10px] text-center text-slate-500 mb-2 italic">Detected by Local Receiver</div>

        <div>
          <div class="flex items-center gap-2 mb-2 text-emerald-400">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 22h20"/><path d="M12 2L2 22"/><path d="M22 22L12 2"/></svg>
            <span class="text-xs font-bold uppercase tracking-wider">Departing</span>
            <span id="countDep" class="ml-auto text-[10px] bg-slate-800 px-1.5 rounded-full text-slate-300">0</span>
          </div>
          <div id="listDep" class="space-y-1.5"></div>
        </div>

        <div>
          <div class="flex items-center gap-2 mb-2 text-sky-400">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" transform="rotate(180)"><path d="M2 22h20"/><path d="M12 2L2 22"/><path d="M22 22L12 2"/></svg>
            <span class="text-xs font-bold uppercase tracking-wider">Arriving</span>
            <span id="countArr" class="ml-auto text-[10px] bg-slate-800 px-1.5 rounded-full text-slate-300">0</span>
          </div>
          <div id="listArr" class="space-y-1.5"></div>
        </div>

      </div>
    </div>
  </aside>

  <!-- ABOUT MODAL -->
  <div id="aboutModal" class="hidden absolute inset-0 z-[2000] flex items-center justify-center p-4">
    <div id="aboutBackdrop" class="absolute inset-0 bg-black/80 backdrop-blur-sm transition-opacity"></div>
    <div class="relative w-full max-w-3xl bg-slate-950 border border-slate-800 rounded-3xl shadow-2xl overflow-hidden microgrid">
      <div class="h-28 bg-gradient-to-r from-blue-900 via-slate-900 to-slate-950 relative overflow-hidden">
        <div class="absolute inset-0 opacity-20" style="background-image: radial-gradient(circle at 2px 2px, rgba(255,255,255,0.3) 1px, transparent 0); background-size: 20px 20px;"></div>
        <div class="absolute bottom-0 left-0 p-6">
          <h2 class="text-2xl font-bold text-white">SamNet Radar ‚Äî System Info</h2>
          <p class="text-sky-400 text-xs font-mono uppercase tracking-wider mt-1">DFW Receiver ‚Ä¢ RTL-SDR ‚Ä¢ dump1090 ‚Ä¢ SamNet UI</p>
        </div>
        <button id="closeAbout" class="absolute top-3 right-3 p-2 bg-black/20 hover:bg-white/10 rounded-full text-white transition">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>
      </div>

      <div class="p-4 sm:p-6 grid grid-cols-1 md:grid-cols-[220px_1fr] gap-4">
        <div id="aboutNav" class="space-y-2"></div>

        <div class="rounded-2xl bg-slate-900/40 border border-slate-800 p-4 sm:p-5">
          <div id="aboutTitle" class="text-lg font-bold text-white flex items-center gap-2"></div>
          <div id="aboutText" class="mt-2 text-sm text-slate-300 leading-relaxed"></div>
          <div id="aboutExtra" class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-3 text-xs text-slate-400"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- ‚úÖ External JS -->
  <script type="module" src="./app.js"></script>
</body>
</html>
